!function(){function e(){navigator.notification&&(window.alert=function(e){navigator.notification.alert(e,null,"Weatherapp","OK")}),FastClick.attach(document.body),s("index"),o(),l=setTimeout(function(){s("search")},1e4),document.addEventListener("menubutton",function(){p?($(".navToggler").removeClass("active"),$("nav").addClass("hide"),$("#page").removeClass("hide"),p=!1):($(".navToggler").addClass("active"),$("nav").removeClass("hide"),$("#page").addClass("hide"),p=!0)},!1),$(".rectangle").each(function(){})}function a(e){switch($(".navToggler").removeClass("active"),e){case"index":$("body").addClass("loading"),navigator.geolocation.getCurrentPosition(u,r,{highAccuracy:!0});break;case"search":$("body").removeClass("loading"),$(".brand").html("Suche"),$("body").attr("data-view","search"),$("#search").submit(function(e){e.preventDefault(),$("body").addClass("loading"),c(!1,!1,$("#city").val())});break;case"impressum":$(".brand").html("Impressum"),$("body").attr("data-view","impressum");break;case"about":$(".brand").html("Über Weatherapp"),$("body").attr("data-view","about")}}function t(){$(".header").click(function(e){e.preventDefault(),p?($(".navToggler").removeClass("active"),$("nav").addClass("hide"),$("#page").removeClass("hide"),p=!1):($(".navToggler").addClass("active"),$("nav").removeClass("hide"),$("#page").addClass("hide"),p=!0)}),$("nav a:not(#exit)").click(function(e){e.preventDefault();var a=$(this).attr("data-href");$("body").attr("data-view",""),s(a)}),$("#exit").click(function(e){e.preventDefault(),navigator.app.exitApp()}),$("#page").on("click",".forecastToggler",function(e){e.preventDefault(),$("#content").addClass("minified"),$("body").addClass("loading"),n(m)})}function n(e){var a={type:"GET",url:"http://api.openweathermap.org/data/2.5/forecast/daily?q="+e+"&units=metric&cnt=7&lang=de",crossDomain:!0};$.ajax(a).success(function(e){if($("body").removeClass("loading"),"404"==e.cod)return s("search"),!1;$("#page").remove("#fc-container"),container=$('<div id="fc-container"></div>'),$("#page").append(container),container.css({height:$(window).height()-$(".header").outerHeight()-176});var a=0;for(key in e.list){elm=$('<div class="fc-elm clearfix"></div>'),container.append(elm),elm.slideUp(0);var t=Array();t.desc=e.list[key].weather[0].description,t.temp0=parseInt(e.list[key].temp.day),t.humidity=parseInt(e.list[key].humidity),t.speed=parseInt(e.list[key].speed),t.date=e.list[key].dt;var n=new Date;n.setDate(n.getDate()+a+1);var r=n.getDate()+"."+(n.getMonth()+1)+"."+n.getFullYear();markup=new Object,markup.desc=$('<p class="desc">'+r+"</p>"),markup.temp=$('<p class="data temperature"><span class="weather-icon '+i(t.desc)+'"></span> '+t.temp0+"°</p>"),markup.humidity=$('<p class="data  extra humid"><span class="humidity"></span> '+t.humidity+"%</p>"),markup.speed=$('<p class="data extra speedo"><span class="speed"></span> '+t.speed+"km/h</p>");for(info in markup)elm.append(markup[info]);elm.delay(500*a).slideDown(300),a++}})}function s(e){$("#page").load("pages/"+e+".html",function(t,n,s){if("error"==n){var r="Sorry but there was an error: ";$("#page").html(r+s.status+" "+s.statusText)}else a(e),$("#page").removeClass("hide")}),$("nav").addClass("hide")}function r(e){$("#content .box").html("code: "+e.code+"<br>message: "+e.message)}function i(e){return e=e.toString(),e=e.trim(),e=e.toLowerCase(),e=e.replace(/ +/g,"-"),e=e.replace("ä","ae"),e=e.replace("ü","ue"),e=e.replace("ö","oe"),e=e.replace("ß","ss")}function o(){navigator.geolocation?navigator.geolocation.getCurrentPosition(d):alert("Geolocation is not supported by this browser.")}function d(e){$("body").removeClass("loading"),$.ajax({type:"GET",url:"http://api.openweathermap.org/data/2.5/weather/?units=metric&lang=de&lat="+e.coords.latitude+"&lon="+e.coords.longitude,crossDomain:!0,beforeSend:function(){$("body").addClass("loading")}}).done(function(e){$("#city").val(e.name),$("body").removeClass("loading"),$("#lat").attr("value",""),$("#lon").attr("value","")})}function c(e,a,t){if($("#content").removeClass("hot"),t)var n={type:"GET",url:"http://api.openweathermap.org/data/2.5/weather?units=metric&lang=de&q="+t,crossDomain:!0};else var n={type:"GET",url:"http://api.openweathermap.org/data/2.5/weather?units=metric&lang=de&lat="+e+"&lon="+a,crossDomain:!0};$.ajax(n).done(function(e){if($("#content").html(""),$("body").attr("data-view","weather"),$("body").removeClass("loading"),"404"==e.cod)return s("search"),!1;""==e.name&&(e.name=e.sys.country),m=e.name;var a=new Date,t=(a.getDay(),Array());t.desc=e.weather[0].description,t.temp0=parseInt(e.main.temp),t.temp1=parseInt(e.main.temp_min),t.temp2=parseInt(e.main.temp_max),t.humidity=parseInt(e.main.humidity),t.speed=parseInt(e.wind.speed),t.temp0>20&&$("#content").addClass("hot"),markup=new Object,$("#content").addClass(i(t.desc)),$(".brand").html(e.name),markup.icon=$('<div class="weather-icon '+i(t.desc)+'"></div>'),markup.desc=$('<p class="data desc center">'+t.desc+"</p>"),markup.temp=$('<p class="data temperature center">'+t.temp0+"°</p>"),markup.temp_min=$('<p class="data center temps"><span>Min: '+t.temp1+"°</span> <span>Max: "+t.temp2+"°</span></p>"),markup.humidity=$('<p class="data  center extra humid"><span class="humidity"></span> <i>feuchtigkeit:</i> '+t.humidity+"%</p>"),markup.speed=$('<p class="data center extra speedo"><span class="speed"></span> <i>windstärke:</i> '+t.speed+"km/h</p>"),markup.button=$('<a class="btn ghost center forecastToggler">Wochenvorhersage</a>');for(elm in markup)$("#content").append(markup[elm])})}var p=(Array("Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"),!1),l=0,m="";document.addEventListener("deviceready",e,!1),$("document").ready(e),t();var u=function(e){lat=e.coords.latitude;var a=e.coords.longitude;c(lat,a,!1),clearTimeout(l)}}();